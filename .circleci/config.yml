version: 2
jobs:
  build:
    docker:
      - image: cirrusci/flutter
    steps:
      - checkout
      - run: flutter doctor -v
      - run:
          name: show app tree
          command: |
            find ./lib -type d -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'
      - run: flutter test
      - run: flutter build apk --debug --split-per-abi
      - run: flutter build apk --profile --split-per-abi
      - run: flutter build apk --split-per-abi

